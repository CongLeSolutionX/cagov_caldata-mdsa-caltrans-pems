{% set district_re='clhouse/meta/d(\\\\d{2})' %}

SELECT
    SUBSTR(FILENAME, 14, 2)::INT AS DISTRICT,
    ID,
    SAMPLE_DATE,
    SAMPLE_TIMESTAMP,
    FLOW_1,
    OCCUPANCY_1,
    SPEED_1,
    FLOW_2 AS FLOW_10,
    OCCUPANCY_2 AS OCCUPANCY_10,
    SPEED_2 AS SPEED_10,
    FLOW_3 AS FLOW_100,
    OCCUPANCY_3 AS OCCUPANCY_100,
    SPEED_3 AS SPEED_100,
    FLOW_4 AS FLOW_1000,
    OCCUPANCY_4 AS OCCUPANCY_1000,
    SPEED_4 AS SPEED_1000,
    FLOW_5 AS FLOW_10000,
    OCCUPANCY_5 AS OCCUPANCY_10000,
    SPEED_5 AS SPEED_10000,
    FLOW_6 AS FLOW_100000,
    OCCUPANCY_6 AS OCCUPANCY_100000,
    SPEED_6 AS SPEED_100000,
    FLOW_7 AS FLOW_1000000,
    OCCUPANCY_7 AS OCCUPANCY_1000000,
    SPEED_7 AS SPEED_1000000,
    FLOW_8 AS FLOW_10000000,
    OCCUPANCY_8 AS OCCUPANCY_10000000,
    SPEED_8 AS SPEED_10000000
FROM {{ source('clearinghouse', 'station_raw') }}
